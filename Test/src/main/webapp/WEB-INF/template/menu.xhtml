<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:p="http://primefaces.org/ui" xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ris="http://java.sun.com/jsf/composite/ris">


	<h:outputScript library="js" name="ris.newmenutree.js" target="head" />
	<h:outputStylesheet library="css" name="ris.newmenutree.css" />
	<hr size="1" />

	<c:choose>
		<c:when test="${currentMenu!=null}">
			<c:set var="menuNow" value="${currentMenu}" />
		</c:when>
	</c:choose>


	<c:set var="LT" value="&lt;" />
	<c:set var="GT" value="&gt;" />
	
	<c:set var="LI_S" value="&lt;li&gt;" />
	<c:set var="LI_E" value="&lt;/li&gt;" />
	<c:set var="UL_S" value="&lt;ul&gt;" />
	<c:set var="UL_E" value="&lt;/ul&gt;" />


	<c:if test="${menuNow!=null}">

		<h:outputText value="#{LT}ul id='navmenu-v' #{GT}" escape="false" />

		<c:forEach var="menu" items="#{menuNow.all}">
			<c:if test="${menu.level==1}">
				<c:if test="${level1_start}">
					<h:outputText value='#{UL_E}' escape="false" />
					<h:outputText value='#{LI_E}' escape="false" />
					<c:set var="level1_start" value="${false}" />
				</c:if>
				<c:if test="${fn:length(menu.children) > 0}">

					<c:set var="level1_start" value="${true}" />
					<h:outputText value='#{LI_S}' escape="false" />
					<div>
						<span>#{menu.text}</span>
					</div>
					<h:outputText value='#{UL_S}' escape="false" />
				</c:if>
				<c:if test="${fn:length(menu.children) == 0}">
					<li><a href='#{request.contextPath}#{menu.url}'>#{menu.text}</a></li>
				</c:if>
			</c:if>
			<c:if test="${menu.level > 1}">
				<li><a href='#{request.contextPath}#{menu.url}'>#{menu.text}</a></li>
			</c:if>
		</c:forEach>
		
		<c:if test="${level1_start}">
			<h:outputText value='#{UL_E}' escape="false" />
			<h:outputText value='#{LI_E}' escape="false" />
			<c:set var="level1_start" value="${false}" />
		</c:if>
		<h:outputText value='#{UL_E}' escape="false" />
	</c:if>

</ui:composition>
